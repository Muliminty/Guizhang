# 开发经验与教训

本目录记录项目开发过程中遇到的问题、解决方案、最佳实践和经验教训。

## 经验记录格式

每条经验记录应包含以下信息：
- **ID**: 经验编号
- **日期**: 记录日期
- **相关任务**: 关联的任务ID
- **问题描述**: 遇到的问题或观察
- **解决方案**: 采取的解决措施
- **经验总结**: 提炼的经验教训
- **影响范围**: 对项目的影响程度
- **避免方法**: 未来如何避免类似问题

---

## 经验记录

### EXP-001
- **日期**: 2026-02-18
- **相关任务**: 项目初始化阶段
- **问题描述**: 在项目分析过程中发现，虽然TASKS.md中定义了75个详细任务，但没有建立持续跟踪任务完成状态的机制。项目进度停留在文档阶段，实际开发进度难以衡量。
- **解决方案**:
  1. 建立任务完成检查机制
  2. 每完成一个任务后，立即更新TASKS.md中的状态
  3. 定期（如每天结束时）进行进度同步
  4. 使用工具（如Task工具）辅助跟踪
- **经验总结**: **每完成一个任务，就继续一次进度和任务的更新**
  - 实时更新任务状态有助于保持项目透明度
  - 避免"文档与实际脱节"的问题
  - 便于识别阻塞任务和依赖关系
  - 为项目回顾提供准确数据
- **影响范围**: 项目管理和开发流程
- **避免方法**:
  1. 将任务状态更新作为开发流程的强制步骤
  2. 在任务模板中加入状态字段
  3. 建立检查清单确保状态更新
  4. 使用自动化工具辅助状态跟踪

### EXP-002
- **日期**: 2026-02-18
- **相关任务**: TASK-001, TASK-002, TASK-003, TASK-009
- **问题描述**: 项目初始分析时发现缺少关键配置文件（tsconfig.json、next.config.js、基础页面文件、工具函数库），导致项目无法正常运行和开发。
- **解决方案**:
  1. 创建完整的TypeScript配置（tsconfig.json），支持路径别名和严格类型检查
  2. 创建Next.js配置（next.config.js），包含图片优化、安全头、PWA支持
  3. 创建基础页面结构（app/layout.tsx、app/page.tsx、app/globals.css）
  4. 创建工具函数库（lib/utils.ts）和类型定义（types/index.ts）
- **经验总结**: **基础配置的完整性决定后续开发效率**
  - 完整的基础配置能避免后续开发中的配置问题
  - 类型安全和代码规范应从项目开始就建立
  - 路径别名和工具函数能显著提高开发效率
  - 文档化的配置便于团队协作和新人上手
- **影响范围**: 开发效率、代码质量、团队协作
- **避免方法**:
  1. 在项目初始化阶段就完成所有基础配置
  2. 使用业界认可的最佳实践配置模板
  3. 配置应包含详细的注释说明
  4. 定期更新配置以跟上技术栈更新

### EXP-003
- **日期**: 2026-02-18
- **相关任务**: TASK-001, TASK-002
- **问题描述**: 在项目构建测试时发现两个配置问题：
  1. TypeScript编译器未安装（package.json中没有typescript依赖）
  2. next.config.js使用CommonJS的`module.exports`，但package.json中设置了`"type": "module"`，导致ES模块冲突
- **解决方案**:
  1. 安装TypeScript编译器：`npm install -D typescript @types/node @types/react @types/react-dom`
  2. 将next.config.js改为ES模块导出：`export default nextConfig` 替代 `module.exports = nextConfig`
- **经验总结**: **配置一致性检查是项目可运行的关键**
  - 配置文件必须与package.json中的模块类型一致
  - 工具链依赖（如TypeScript编译器）必须明确安装
  - 构建前的配置验证能节省调试时间
  - 自动化测试应包含配置验证步骤
- **影响范围**: 项目构建、开发环境、部署流程
- **避免方法**:
  1. 创建配置检查清单（模块类型、依赖完整性）
  2. 在项目初始化后立即运行构建测试
  3. 使用自动化脚本验证配置
  4. 文档化配置依赖关系

### EXP-004
- **日期**: 2026-02-18
- **相关任务**: TASK-001, TASK-003
- **问题描述**: 构建测试发现更多配置问题：
  1. Next.js配置包含已弃用的`swcMinify`选项（Next.js 15+使用Turbopack）
  2. Next.js实验性选项`preloadEntries`不被当前版本支持
  3. Tailwind CSS v4需要单独的PostCSS插件`@tailwindcss/postcss`
- **解决方案**:
  1. 移除`swcMinify: true`配置
  2. 移除不支持的`preloadEntries: true`选项
  3. 安装`@tailwindcss/postcss`并更新postcss.config.js
- **经验总结**: **技术栈版本兼容性是配置成功的基础**
  - 配置选项需要与框架版本匹配
  - 新版本技术栈可能有重大变更（如Tailwind CSS v4）
  - 构建错误信息通常包含具体的修复指导
  - 实验性功能可能不稳定或已变更
- **影响范围**: 构建流程、开发体验、生产部署
- **避免方法**:
  1. 仔细阅读技术栈版本的迁移指南
  2. 使用官方配置生成工具
  3. 逐步验证配置而非一次性全部配置
  4. 关注控制台警告信息

### EXP-005
- **日期**: 2026-02-18
- **相关任务**: 所有配置任务
- **问题描述**: 配置完成后需要验证项目是否真正可运行
- **解决方案**:
  1. 运行构建测试：`npm run build`
  2. 启动开发服务器：`npm run dev`
  3. 检查TypeScript编译：`npx tsc --noEmit`
  4. 验证路由和页面生成
- **经验总结**: **构建成功是配置完成的唯一标准**
  - 配置文件正确不等于项目可运行
  - 必须通过完整的构建流程验证
  - 开发服务器启动是最终验收标准
  - 自动化构建验证应纳入开发流程
- **影响范围**: 项目交付质量、开发信心、团队协作
- **避免方法**:
  1. 每次配置变更后运行构建测试
  2. 建立CI/CD流水线自动验证
  3. 文档化构建成功标准
  4. 创建配置验证检查清单

### 实施建议
1. **开发前**: 确认任务状态为"进行中"
2. **开发中**: 记录遇到的问题和解决方案
3. **完成后**:
   - 立即更新任务状态为"已完成"
   - 记录实际工时（与原估计对比）
   - 更新相关文档和代码注释
   - 创建或更新相关测试
4. **每日同步**: 汇总当日完成的任务，更新整体进度

### 工具支持
- 使用Claude Code的Task工具进行任务管理
- 利用Git提交信息关联任务ID
- 考虑集成项目管理工具（如Jira、Trello等）

---

## 目录结构说明

```
经验/
├── README.md                 # 本文件，经验记录索引和格式说明
├── 任务跟踪.md               # 实际任务进度跟踪（TASKS.md的补充）
└── 每日日志/                 # 每日开发日志
    ├── 2026-02-18.md        # 当日详细工作记录
    └── ...                  # 后续日期日志
```

## 使用方法

### 1. 记录新经验
当遇到问题、发现最佳实践或有重要学习时：
1. 在`README.md`中添加新经验记录（格式参照EXP-001）
2. 更新相关任务的`经验ID`字段
3. 在当日日志中记录触发场景

### 2. 更新任务进度
每完成一个任务或任务阶段：
1. 更新`任务跟踪.md`中的任务状态
2. 记录实际工时和完成内容
3. 关联相关经验ID
4. 在当日日志中记录工作详情

### 3. 记录每日日志
每天工作结束时：
1. 创建新的日志文件（如`YYYY-MM-DD.md`）
2. 记录当日完成的工作、遇到的问题、经验总结
3. 制定明日计划
4. 更新整体进度概览

## 价值与收益
1. **知识沉淀**: 避免重复踩坑，积累团队经验
2. **进度透明**: 实时了解项目真实进展
3. **过程改进**: 通过经验总结优化开发流程
4. **质量保障**: 问题记录和解决方案归档
5. **新人上手**: 提供完整的历史记录和学习资料

---
*持续更新中...*